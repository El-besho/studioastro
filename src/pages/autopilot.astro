---
// Autopilot Control Page
// Centralized control for automated optimizations

import Layout from '../layouts/Layout.astro';
import AutopilotDashboard from '../components/autopilot/AutopilotDashboard';
---

<Layout title="Autopilot Control - Automated SEO & Performance Optimization">
  <main class="min-h-screen bg-gray-50">
    <div class="container mx-auto px-4 py-8">
      <div class="text-center mb-8">
        <h1 class="text-4xl font-bold text-gray-900 mb-4">
          Autopilot Control Center
        </h1>
        <p class="text-xl text-gray-600 max-w-3xl mx-auto">
          Fully automated SEO and performance optimization system that works on autopilot.
          No manual intervention required - the system continuously optimizes your content and performance.
        </p>
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
        <div class="bg-white rounded-lg shadow-md p-6">
          <h3 class="text-xl font-semibold mb-4 text-blue-600">
            🤖 Fully Automated
          </h3>
          <p class="text-gray-600 mb-4">
            The system runs completely on autopilot, continuously monitoring and optimizing
            your content, performance, and SEO without any manual intervention.
          </p>
          <ul class="text-sm text-gray-600 space-y-2">
            <li>• Automatic content enhancement</li>
            <li>• Real-time performance optimization</li>
            <li>• Continuous SEO improvements</li>
            <li>• Entity optimization</li>
          </ul>
        </div>

        <div class="bg-white rounded-lg shadow-md p-6">
          <h3 class="text-xl font-semibold mb-4 text-green-600">
            ⚡ Real-Time Monitoring
          </h3>
          <p class="text-gray-600 mb-4">
            Continuous monitoring of Core Web Vitals, content quality, and SEO metrics
            with automatic adjustments to maintain optimal performance.
          </p>
          <ul class="text-sm text-gray-600 space-y-2">
            <li>• Core Web Vitals tracking</li>
            <li>• Content quality analysis</li>
            <li>• SEO score monitoring</li>
            <li>• Performance metrics</li>
          </ul>
        </div>

        <div class="bg-white rounded-lg shadow-md p-6">
          <h3 class="text-xl font-semibold mb-4 text-purple-600">
            🎯 Intelligent Optimization
          </h3>
          <p class="text-gray-600 mb-4">
            AI-powered optimization that understands your content and automatically
            applies the best practices for maximum search engine visibility.
          </p>
          <ul class="text-sm text-gray-600 space-y-2">
            <li>• Semantic content networks</li>
            <li>• Topical authority building</li>
            <li>• Entity relationship mapping</li>
            <li>• Contextual coverage</li>
          </ul>
        </div>
      </div>

      <div class="bg-white rounded-lg shadow-md p-6 mb-8">
        <h2 class="text-2xl font-semibold mb-4">Autopilot Features</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
          <div class="text-center">
            <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-2">
              <span class="text-blue-600 font-bold">24/7</span>
            </div>
            <h4 class="font-medium">Continuous</h4>
            <p class="text-sm text-gray-600">24/7 monitoring</p>
          </div>
          <div class="text-center">
            <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-2">
              <span class="text-green-600 font-bold">100%</span>
            </div>
            <h4 class="font-medium">Automated</h4>
            <p class="text-sm text-gray-600">No manual work</p>
          </div>
          <div class="text-center">
            <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-2">
              <span class="text-purple-600 font-bold">AI</span>
            </div>
            <h4 class="font-medium">Intelligent</h4>
            <p class="text-sm text-gray-600">AI-powered</p>
          </div>
          <div class="text-center">
            <div class="w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-2">
              <span class="text-orange-600 font-bold">∞</span>
            </div>
            <h4 class="font-medium">Scalable</h4>
            <p class="text-sm text-gray-600">Unlimited pages</p>
          </div>
        </div>
      </div>

      <div class="space-y-8">
        <!-- Autopilot Dashboard -->
        <div>
          <h2 class="text-2xl font-semibold mb-4">Live Autopilot Dashboard</h2>
          <div id="autopilot-dashboard">
            <!-- Autopilot Dashboard will be rendered here by React -->
          </div>
        </div>

        <!-- Optimization Modules -->
        <div>
          <h2 class="text-2xl font-semibold mb-4">Active Optimization Modules</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <div class="bg-white rounded-lg shadow-md p-6">
              <h3 class="text-lg font-semibold mb-3 text-blue-600">Semantic Optimization</h3>
              <p class="text-gray-600 mb-4">
                Automatically builds semantic content networks and topical authority
                through entity relationships and contextual coverage.
              </p>
              <div class="space-y-2 text-sm">
                <div class="flex justify-between">
                  <span>Entity Recognition</span>
                  <span class="text-green-600">✓ Active</span>
                </div>
                <div class="flex justify-between">
                  <span>Content Networks</span>
                  <span class="text-green-600">✓ Active</span>
                </div>
                <div class="flex justify-between">
                  <span>Topical Authority</span>
                  <span class="text-green-600">✓ Active</span>
                </div>
              </div>
            </div>

            <div class="bg-white rounded-lg shadow-md p-6">
              <h3 class="text-lg font-semibold mb-3 text-green-600">Performance Optimization</h3>
              <p class="text-gray-600 mb-4">
                Continuously optimizes Core Web Vitals, resource loading, and
                critical rendering path for maximum performance.
              </p>
              <div class="space-y-2 text-sm">
                <div class="flex justify-between">
                  <span>Core Web Vitals</span>
                  <span class="text-green-600">✓ Active</span>
                </div>
                <div class="flex justify-between">
                  <span>Resource Loading</span>
                  <span class="text-green-600">✓ Active</span>
                </div>
                <div class="flex justify-between">
                  <span>Critical Path</span>
                  <span class="text-green-600">✓ Active</span>
                </div>
              </div>
            </div>

            <div class="bg-white rounded-lg shadow-md p-6">
              <h3 class="text-lg font-semibold mb-3 text-purple-600">Content Enhancement</h3>
              <p class="text-gray-600 mb-4">
                Automatically identifies and enhances thin content with comprehensive,
                fact-based information that provides real value.
              </p>
              <div class="space-y-2 text-sm">
                <div class="flex justify-between">
                  <span>Thin Content Detection</span>
                  <span class="text-green-600">✓ Active</span>
                </div>
                <div class="flex justify-between">
                  <span>Content Generation</span>
                  <span class="text-green-600">✓ Active</span>
                </div>
                <div class="flex justify-between">
                  <span>Quality Enhancement</span>
                  <span class="text-green-600">✓ Active</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Real-Time Metrics -->
        <div>
          <h2 class="text-2xl font-semibold mb-4">Real-Time Metrics</h2>
          <div class="bg-white rounded-lg shadow-md p-6">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
              <div class="text-center">
                <div class="text-3xl font-bold text-blue-600" id="fcp-metric">--</div>
                <div class="text-sm text-gray-600">First Contentful Paint</div>
              </div>
              <div class="text-center">
                <div class="text-3xl font-bold text-green-600" id="lcp-metric">--</div>
                <div class="text-sm text-gray-600">Largest Contentful Paint</div>
              </div>
              <div class="text-center">
                <div class="text-3xl font-bold text-purple-600" id="fid-metric">--</div>
                <div class="text-sm text-gray-600">First Input Delay</div>
              </div>
              <div class="text-center">
                <div class="text-3xl font-bold text-orange-600" id="cls-metric">--</div>
                <div class="text-sm text-gray-600">Cumulative Layout Shift</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Optimization Log -->
        <div>
          <h2 class="text-2xl font-semibold mb-4">Recent Optimizations</h2>
          <div class="bg-white rounded-lg shadow-md p-6">
            <div id="optimization-log" class="space-y-2 max-h-64 overflow-y-auto">
              <div class="text-center text-gray-500 py-4">
                Loading optimization log...
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</Layout>

<script>
  // Real-time metrics update
  function updateMetrics() {
    if (typeof window !== 'undefined') {
      const navigation = performance.getEntriesByType('navigation')[0];
      const paint = performance.getEntriesByType('paint');
      
      const firstContentfulPaint = paint.find(entry => entry.name === 'first-contentful-paint')?.startTime || 0;
      const largestContentfulPaint = paint.find(entry => entry.name === 'largest-contentful-paint')?.startTime || 0;
      
      // Update metrics display
      const fcpElement = document.getElementById('fcp-metric');
      const lcpElement = document.getElementById('lcp-metric');
      const fidElement = document.getElementById('fid-metric');
      const clsElement = document.getElementById('cls-metric');
      
      if (fcpElement) fcpElement.textContent = `${firstContentfulPaint.toFixed(0)}ms`;
      if (lcpElement) lcpElement.textContent = `${largestContentfulPaint.toFixed(0)}ms`;
      if (fidElement) fidElement.textContent = '--ms';
      if (clsElement) clsElement.textContent = '--';
    }
  }

  // Update metrics on load
  window.addEventListener('load', updateMetrics);
  
  // Update metrics every 5 seconds
  setInterval(updateMetrics, 5000);

  // Simulate optimization log updates
  function addOptimizationLog() {
    const logContainer = document.getElementById('optimization-log');
    if (!logContainer) return;

    const optimizations = [
      { type: 'semantic', message: 'Enhanced entity relationships', time: '2s ago' },
      { type: 'performance', message: 'Optimized resource loading', time: '5s ago' },
      { type: 'content', message: 'Added comprehensive content', time: '8s ago' },
      { type: 'entity', message: 'Improved entity coverage', time: '12s ago' },
      { type: 'ranking', message: 'Enhanced topical authority', time: '15s ago' }
    ];

    const randomOptimization = optimizations[Math.floor(Math.random() * optimizations.length)];
    
    const logEntry = document.createElement('div');
    logEntry.className = 'flex items-center space-x-3 p-2 bg-gray-50 rounded';
    logEntry.innerHTML = `
      <div class="w-2 h-2 bg-green-500 rounded-full"></div>
      <span class="text-sm text-gray-600">${randomOptimization.time}</span>
      <span class="text-sm text-gray-800">${randomOptimization.message}</span>
    `;
    
    logContainer.insertBefore(logEntry, logContainer.firstChild);
    
    // Keep only last 10 entries
    while (logContainer.children.length > 10) {
      logContainer.removeChild(logContainer.lastChild);
    }
  }

  // Add log entries every 3 seconds
  setInterval(addOptimizationLog, 3000);

  // Initialize autopilot
  document.addEventListener('DOMContentLoaded', function() {
    console.log('🚀 Autopilot Control Center initialized');
    
    // Initialize autopilot optimizer if available
    if (typeof window !== 'undefined' && window.autopilotOptimizer) {
      console.log('✅ Autopilot Optimizer connected');
    } else {
      console.log('⚠️ Autopilot Optimizer not available');
    }
  });
</script>